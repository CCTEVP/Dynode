# ================================================
# Echo.dynode WebSocket Server Configuration
# ================================================

# ============================================
# REQUIRED: Core Configuration
# ============================================

# Node environment (development, staging, production)
NODE_ENV=production

# Authentication secret for token generation (CRITICAL - must be 32+ characters)
# Generate with: node -e "console.log(require('crypto').randomBytes(32).toString('base64'))"
AUTH_SECRET=your-secure-secret-here-minimum-32-chars

# Server port
PORT=8080
PORT_ENV=8080

# Public base URL for documentation and links
PUBLIC_BASE_URL=https://your-server.run.app

# Source.dynode URL for centralized logging
# In docker: http://source.dynode:8080
# External: https://source-dynode.run.app or http://localhost:3000
SOURCE_BASE_URL=http://localhost:3000
# Alternative: PUBLIC_SOURCE_URL=https://source-dynode.run.app

# ============================================
# SECURITY: CORS Configuration
# ============================================

# Comma-separated list of allowed origins for CORS
# REQUIRED in production - leave empty in dev to allow all origins
# Examples:
#   Single origin: https://example.com
#   Multiple origins: https://example.com,https://app.example.com
#   Wildcard subdomain: *.example.com
ORIGIN_ALLOWLIST=https://example.com,https://app.example.com

# ============================================
# SECURITY: Permanent Tokens (Optional Override)
# ============================================

# Override hardcoded permanent tokens with environment variables
# Generate tokens with: node src/utils/generate-test-token.js
# TOKEN_SCREEN=your-screen-token-here
# TOKEN_ADVERTISER=your-advertiser-token-here
# TOKEN_CONTROL=your-control-token-here
# TOKEN_MONITOR=your-monitor-token-here

# ============================================
# DOCUMENTATION: Authentication
# ============================================

# SHA-256 hash of email for /docs login
# Generate with: node -e "const crypto = require('crypto'); console.log(crypto.createHash('sha256').update('your.email@domain.com'.toLowerCase().trim()).digest('hex'));"
DOCS_EMAIL_HASH=fcbfdedbc3b28d65bc9a9ded46e659c956432e3090a698ed285e831c63036a48

# SHA-256 hash of password for /docs login
# Generate with: node -e "const crypto = require('crypto'); console.log(crypto.createHash('sha256').update('yourpassword'.trim()).digest('hex'));"
DOCS_PASSWORD_HASH=f5a743eb69dc8e890eb345eb296132730bc2cc0273381c073c1fe800ca85d9cd

# ============================================
# WEBSOCKET: Connection Management
# ============================================

# Heartbeat/ping interval in milliseconds (0 to disable)
# Recommended: 30000 (30 seconds) to keep connections alive through proxies
HEARTBEAT_INTERVAL_MS=30000

# Idle timeout in milliseconds (0 to disable)
# Disconnect clients that don't send messages within this period
IDLE_TIMEOUT_MS=0

# Maximum connection age in milliseconds (0 to disable)
# Force reconnection after this period for security/resource management
# Recommended in production: 3600000 (1 hour)
MAX_CONN_AGE_MS=0

# Maximum WebSocket message payload size in bytes
MAX_PAYLOAD_BYTES=1048576

# ============================================
# CONTENT: Broadcast Configuration
# ============================================

# Maximum POST content size in bytes
POST_CONTENT_MAX_BYTES=262144

# Radio room broadcast delay in seconds
RADIO_POST_BROADCAST_DELAY_SECONDS=30

# ============================================
# LOGGING: Configuration
# ============================================

# Log level: error, warn, info, debug
LOG_LEVEL=info

# Enable local Winston file logging in addition to remote logging
# Default: enabled in development, disabled in production
# ENABLE_LOCAL_LOGS=true

# ============================================
# REDIS: Session Storage (Optional)
# ============================================

# Redis URL for session storage (recommended in production)
# If not set, sessions stored in memory (lost on restart)
# Example: redis://localhost:6379
# REDIS_URL=redis://your-redis-host:6379

# ============================================
# MONITORING: Error Tracking (Optional)
# ============================================

# Sentry DSN for error tracking
# SENTRY_DSN=https://your-sentry-dsn@sentry.io/project-id

# ============================================
# DEVELOPMENT: Additional Settings
# ============================================

# Enable detailed debug logs (development only)
# DEBUG=echo:*
