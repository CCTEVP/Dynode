{
  "/data/folders": {
    "get": {
      "summary": "Get all folders",
      "tags": ["Folders"],
      "description": "Retrieve all folders for the current user/domain, sorted alphabetically by name",
      "responses": {
        "200": {
          "description": "List of folders retrieved successfully",
          "content": {
            "application/json": {
              "schema": {
                "type": "array",
                "items": {
                  "$ref": "#/components/schemas/Folder"
                }
              }
            }
          }
        },
        "401": { "description": "Unauthorized" },
        "500": { "description": "Failed to retrieve folders" }
      }
    },
    "post": {
      "summary": "Create a new folder",
      "tags": ["Folders"],
      "description": "Create a new folder with optional parent and color. Max depth is 3 levels (0=root, 1=child, 2=grandchild)",
      "requestBody": {
        "required": true,
        "content": {
          "application/json": {
            "schema": {
              "type": "object",
              "required": ["name"],
              "properties": {
                "name": {
                  "type": "string",
                  "description": "The name of the folder",
                  "minLength": 1,
                  "maxLength": 50
                },
                "parent": {
                  "type": "string",
                  "description": "Parent folder ID (ObjectId). Omit for root-level folder",
                  "pattern": "^[0-9a-fA-F]{24}$"
                },
                "color": {
                  "type": "string",
                  "description": "Optional color code for the folder",
                  "pattern": "^#[0-9a-fA-F]{6}$"
                }
              }
            }
          }
        }
      },
      "responses": {
        "201": {
          "description": "Folder created successfully",
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/Folder"
              }
            }
          }
        },
        "400": {
          "description": "Bad request - invalid data or max depth exceeded",
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "message": {
                    "type": "string",
                    "example": "Maximum folder depth (3 levels) exceeded."
                  }
                }
              }
            }
          }
        },
        "404": { "description": "Parent folder not found" },
        "401": { "description": "Unauthorized" },
        "500": { "description": "Failed to create folder" }
      }
    }
  },
  "/data/folders/{id}": {
    "get": {
      "summary": "Get a folder by ID",
      "tags": ["Folders"],
      "description": "Retrieve a single folder by its ID",
      "parameters": [
        {
          "name": "id",
          "in": "path",
          "required": true,
          "schema": {
            "type": "string",
            "pattern": "^[0-9a-fA-F]{24}$"
          },
          "description": "Folder ID (ObjectId)"
        }
      ],
      "responses": {
        "200": {
          "description": "Folder retrieved successfully",
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/Folder"
              }
            }
          }
        },
        "400": { "description": "Invalid folder ID" },
        "404": { "description": "Folder not found" },
        "401": { "description": "Unauthorized" },
        "500": { "description": "Failed to retrieve folder" }
      }
    },
    "put": {
      "summary": "Update a folder",
      "tags": ["Folders"],
      "description": "Update folder name, parent, or color. Moving folders validates depth limits and prevents circular references",
      "parameters": [
        {
          "name": "id",
          "in": "path",
          "required": true,
          "schema": {
            "type": "string",
            "pattern": "^[0-9a-fA-F]{24}$"
          },
          "description": "Folder ID (ObjectId)"
        }
      ],
      "requestBody": {
        "required": true,
        "content": {
          "application/json": {
            "schema": {
              "type": "object",
              "properties": {
                "name": {
                  "type": "string",
                  "description": "Updated folder name",
                  "minLength": 1,
                  "maxLength": 50
                },
                "parent": {
                  "type": ["string", "null"],
                  "description": "New parent folder ID (ObjectId) or null to move to root",
                  "pattern": "^[0-9a-fA-F]{24}$"
                },
                "color": {
                  "type": ["string", "null"],
                  "description": "Updated color code or null to remove color",
                  "pattern": "^#[0-9a-fA-F]{6}$"
                }
              }
            }
          }
        }
      },
      "responses": {
        "200": {
          "description": "Folder updated successfully",
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/Folder"
              }
            }
          }
        },
        "400": {
          "description": "Bad request - invalid data, circular reference, or max depth exceeded",
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "message": {
                    "type": "string",
                    "example": "Cannot move folder to one of its descendants."
                  }
                }
              }
            }
          }
        },
        "404": { "description": "Folder or parent folder not found" },
        "401": { "description": "Unauthorized" },
        "500": { "description": "Failed to update folder" }
      }
    },
    "delete": {
      "summary": "Delete a folder",
      "tags": ["Folders"],
      "description": "Delete a folder. Items in the folder remain, they just lose their folder reference. Cannot delete folders with subfolders",
      "parameters": [
        {
          "name": "id",
          "in": "path",
          "required": true,
          "schema": {
            "type": "string",
            "pattern": "^[0-9a-fA-F]{24}$"
          },
          "description": "Folder ID (ObjectId)"
        }
      ],
      "responses": {
        "204": { "description": "Folder deleted successfully" },
        "400": {
          "description": "Cannot delete folder with subfolders",
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "message": {
                    "type": "string",
                    "example": "Cannot delete folder with subfolders. Please delete or move child folders first."
                  }
                }
              }
            }
          }
        },
        "404": { "description": "Folder not found" },
        "401": { "description": "Unauthorized" },
        "500": { "description": "Failed to delete folder" }
      }
    }
  },
  "/data/folders/{id}/breadcrumb": {
    "get": {
      "summary": "Get folder breadcrumb path",
      "tags": ["Folders"],
      "description": "Get the folder path from root to the specified folder",
      "parameters": [
        {
          "name": "id",
          "in": "path",
          "required": true,
          "schema": {
            "type": "string",
            "pattern": "^[0-9a-fA-F]{24}$"
          },
          "description": "Folder ID (ObjectId)"
        }
      ],
      "responses": {
        "200": {
          "description": "Breadcrumb path retrieved successfully",
          "content": {
            "application/json": {
              "schema": {
                "type": "array",
                "items": {
                  "type": "object",
                  "properties": {
                    "_id": {
                      "type": "string",
                      "description": "Folder ID"
                    },
                    "name": {
                      "type": "string",
                      "description": "Folder name"
                    },
                    "color": {
                      "type": "string",
                      "description": "Folder color (if set)"
                    }
                  }
                }
              }
            }
          }
        },
        "400": { "description": "Invalid folder ID" },
        "401": { "description": "Unauthorized" },
        "500": { "description": "Failed to build breadcrumb" }
      }
    }
  },
  "/data/folders/{id}/depth": {
    "get": {
      "summary": "Get folder depth level",
      "tags": ["Folders"],
      "description": "Get the depth level of a folder (0=root, 1=child, 2=grandchild)",
      "parameters": [
        {
          "name": "id",
          "in": "path",
          "required": true,
          "schema": {
            "type": "string",
            "pattern": "^[0-9a-fA-F]{24}$"
          },
          "description": "Folder ID (ObjectId)"
        }
      ],
      "responses": {
        "200": {
          "description": "Depth level retrieved successfully",
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "depth": {
                    "type": "integer",
                    "minimum": 0,
                    "maximum": 2,
                    "description": "Folder depth level (0-2)"
                  }
                }
              }
            }
          }
        },
        "400": { "description": "Invalid folder ID" },
        "401": { "description": "Unauthorized" },
        "500": { "description": "Failed to calculate folder depth" }
      }
    }
  },
  "/data/folders/{id}/isEmpty": {
    "get": {
      "summary": "Check if folder is empty",
      "tags": ["Folders"],
      "description": "Check if a folder has no items (creatives, sources, or assets) assigned to it",
      "parameters": [
        {
          "name": "id",
          "in": "path",
          "required": true,
          "schema": {
            "type": "string",
            "pattern": "^[0-9a-fA-F]{24}$"
          },
          "description": "Folder ID (ObjectId)"
        }
      ],
      "responses": {
        "200": {
          "description": "Empty status retrieved successfully",
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "isEmpty": {
                    "type": "boolean",
                    "description": "True if folder has no items assigned"
                  }
                }
              }
            }
          }
        },
        "400": { "description": "Invalid folder ID" },
        "404": { "description": "Folder not found" },
        "401": { "description": "Unauthorized" },
        "500": { "description": "Failed to check folder status" }
      }
    }
  },
  "/data/folders/{id}/items": {
    "post": {
      "summary": "Add item to folder",
      "tags": ["Folders"],
      "description": "Add a single creative, source, or asset to a folder",
      "parameters": [
        {
          "name": "id",
          "in": "path",
          "required": true,
          "schema": {
            "type": "string",
            "pattern": "^[0-9a-fA-F]{24}$"
          },
          "description": "Folder ID (ObjectId)"
        }
      ],
      "requestBody": {
        "required": true,
        "content": {
          "application/json": {
            "schema": {
              "type": "object",
              "required": ["type", "itemId"],
              "properties": {
                "type": {
                  "type": "string",
                  "enum": ["creatives", "sources", "assets"],
                  "description": "The type of item to add"
                },
                "itemId": {
                  "type": "string",
                  "pattern": "^[0-9a-fA-F]{24}$",
                  "description": "Item ID (ObjectId)"
                }
              }
            }
          }
        }
      },
      "responses": {
        "200": {
          "description": "Item added to folder successfully",
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/Folder"
              }
            }
          }
        },
        "400": { "description": "Invalid folder ID, item type, or item ID" },
        "404": { "description": "Folder not found" },
        "401": { "description": "Unauthorized" },
        "500": { "description": "Failed to add item to folder" }
      }
    }
  },
  "/data/folders/{id}/items/{type}/{itemId}": {
    "delete": {
      "summary": "Remove item from folder",
      "tags": ["Folders"],
      "description": "Remove a single creative, source, or asset from a folder",
      "parameters": [
        {
          "name": "id",
          "in": "path",
          "required": true,
          "schema": {
            "type": "string",
            "pattern": "^[0-9a-fA-F]{24}$"
          },
          "description": "Folder ID (ObjectId)"
        },
        {
          "name": "type",
          "in": "path",
          "required": true,
          "schema": {
            "type": "string",
            "enum": ["creatives", "sources", "assets"]
          },
          "description": "The type of item to remove"
        },
        {
          "name": "itemId",
          "in": "path",
          "required": true,
          "schema": {
            "type": "string",
            "pattern": "^[0-9a-fA-F]{24}$"
          },
          "description": "Item ID (ObjectId)"
        }
      ],
      "responses": {
        "200": {
          "description": "Item removed from folder successfully",
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/Folder"
              }
            }
          }
        },
        "400": { "description": "Invalid folder ID, item type, or item ID" },
        "401": { "description": "Unauthorized" },
        "500": { "description": "Failed to remove item from folder" }
      }
    }
  },
  "/data/folders/bulk-assign": {
    "post": {
      "summary": "Bulk assign items to folder",
      "tags": ["Folders"],
      "description": "Assign multiple items to a folder at once. If folderId is null, items are removed from all folders",
      "requestBody": {
        "required": true,
        "content": {
          "application/json": {
            "schema": {
              "type": "object",
              "required": ["itemType", "itemIds"],
              "properties": {
                "folderId": {
                  "type": ["string", "null"],
                  "pattern": "^[0-9a-fA-F]{24}$",
                  "description": "Target folder ID (ObjectId) or null to remove from all folders"
                },
                "itemType": {
                  "type": "string",
                  "enum": ["creatives", "sources", "assets"],
                  "description": "The type of items to assign"
                },
                "itemIds": {
                  "type": "array",
                  "items": {
                    "type": "string",
                    "pattern": "^[0-9a-fA-F]{24}$"
                  },
                  "minItems": 1,
                  "description": "Array of item IDs (ObjectIds) to assign"
                }
              }
            }
          }
        }
      },
      "responses": {
        "200": {
          "description": "Items assigned successfully",
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "message": {
                    "type": "string",
                    "example": "Items assigned successfully."
                  }
                }
              }
            }
          }
        },
        "400": { "description": "Invalid item type, folder ID, or item IDs" },
        "404": { "description": "Folder not found" },
        "401": { "description": "Unauthorized" },
        "500": { "description": "Failed to assign items" }
      }
    }
  },
  "components": {
    "schemas": {
      "Folder": {
        "type": "object",
        "properties": {
          "_id": {
            "type": "string",
            "description": "Folder ID (ObjectId)"
          },
          "name": {
            "type": "string",
            "description": "Folder name"
          },
          "owner": {
            "type": "object",
            "properties": {
              "domain": {
                "type": "string",
                "description": "Domain ID (ObjectId)"
              },
              "user": {
                "type": "string",
                "description": "User ID (ObjectId)"
              }
            },
            "description": "Folder owner information"
          },
          "items": {
            "type": "object",
            "properties": {
              "creatives": {
                "type": "array",
                "items": {
                  "type": "string"
                },
                "description": "Array of creative IDs (ObjectIds)"
              },
              "sources": {
                "type": "array",
                "items": {
                  "type": "string"
                },
                "description": "Array of source IDs (ObjectIds)"
              },
              "assets": {
                "type": "array",
                "items": {
                  "type": "string"
                },
                "description": "Array of asset IDs (ObjectIds)"
              }
            },
            "description": "Items contained in this folder"
          },
          "domains": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "description": "Array of domain IDs (ObjectIds) with access"
          },
          "parent": {
            "type": "string",
            "description": "Parent folder ID (ObjectId) - omitted for root folders"
          },
          "attributes": {
            "type": "object",
            "properties": {
              "color": {
                "type": "string",
                "description": "Folder color code"
              }
            },
            "description": "Folder attributes"
          },
          "created": {
            "type": "string",
            "format": "date-time",
            "description": "Creation timestamp"
          },
          "updated": {
            "type": "string",
            "format": "date-time",
            "description": "Last update timestamp"
          }
        }
      }
    }
  }
}
