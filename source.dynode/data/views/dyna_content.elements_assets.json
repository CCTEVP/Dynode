{
  "viewOn": "elements",
  "pipeline": [
    {
      "$lookup": {
        "from": "assets",
        "let": { "sourceId": "$source._id" },
        "pipeline": [
          { "$unwind": "$bundle" },
          { "$match": { "$expr": { "$eq": ["$bundle._id", "$$sourceId"] } } },
          { "$replaceRoot": { "newRoot": "$bundle" } }
        ],
        "as": "sourceAsset"
      }
    },
    {
      "$addFields": {
        "source": {
          "$cond": {
            "if": { "$gt": [{ "$size": "$sourceAsset" }, 0] },
            "then": { "$arrayElemAt": ["$sourceAsset", 0] },
            "else": "$$REMOVE"
          }
        }
      }
    },
    {
      "$project": {
        "sourceAsset": 0
      }
    },
    {
      "$lookup": {
        "from": "assets",
        "let": { "fontId": "$font._id" },
        "pipeline": [
          { "$unwind": "$bundle" },
          { "$match": { "$expr": { "$eq": ["$bundle._id", "$$fontId"] } } },
          { "$replaceRoot": { "newRoot": "$bundle" } }
        ],
        "as": "fontAsset"
      }
    },
    {
      "$addFields": {
        "font": {
          "$cond": {
            "if": { "$gt": [{ "$size": "$fontAsset" }, 0] },
            "then": { "$arrayElemAt": ["$fontAsset", 0] },
            "else": "$$REMOVE"
          }
        }
      }
    },
    {
      "$project": {
        "fontAsset": 0
      }
    }
  ]
}
