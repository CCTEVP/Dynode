{
  "viewOn": "creatives_assemblies",
  "pipeline": [
    {
      "$addFields": {
        "origin": "assemblies"
      }
    },
    {
      "$unionWith": {
        "coll": "creatives_dynamics",
        "pipeline": [
          {
            "$addFields": {
              "origin": "dynamics"
            }
          }
        ]
      }
    },
    {
      "$unionWith": {
        "coll": "creatives_interactives",
        "pipeline": [
          {
            "$addFields": {
              "origin": "interactives"
            }
          }
        ]
      }
    },
    {
      "$lookup": {
        "from": "formats",
        "localField": "format",
        "foreignField": "_id",
        "as": "formatArray"
      }
    },
    {
      "$addFields": {
        "format": {
          "$cond": {
            "if": {
              "$gt": [
                {
                  "$size": "$formatArray"
                },
                0
              ]
            },
            "then": {
              "$arrayElemAt": ["$formatArray", 0]
            },
            "else": "$format"
          }
        }
      }
    },
    {
      "$project": {
        "formatArray": 0
      }
    }
  ]
}
